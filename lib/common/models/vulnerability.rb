# encoding: UTF-8

require 'vulnerability/output'

class Vulnerability
  include Vulnerability::Output

  attr_accessor :title, :references, :type, :metasploit_modules

  def initialize(title, type, references, metasploit_modules = [])
    @title              = title
    @type               = type
    @references         = references
    @metasploit_modules = metasploit_modules
  end

  def self.load_from_xml_node(xml_node)
    new(
      xml_node.search('title').text,
      xml_node.search('type').text,
      xml_node.search('reference').map(&:text),
      xml_node.search('metasploit').map(&:text)
    )
  end

end
